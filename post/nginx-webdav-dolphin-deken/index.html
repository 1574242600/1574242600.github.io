<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.b7d6485fdbb655d6d735.css" data-identity="gatsby-global-css">@media (min-width:992px){.layout-module--sidebar-open-offset--3lG32{margin-left:300px}}.layout-module--pages--16eZ4{display:flex;flex-wrap:wrap;justify-content:center;margin-top:80px}.toolbar-module--toolbar--1GBl7{background-color:var(--primary-color);left:0;padding:12px;position:fixed;right:0;top:0;z-index:100}.toolbar-module--toolbar-shadow--2zjJP{box-shadow:0 0 10px rgba(0,0,0,.5)}.toolbar-module--icon--3lesc{color:#eee;font-size:32px}.toolbar-module--title--3e0YB{color:#eee;font-size:24px;padding-left:24px}.dark .toolbar-module--toolbar--1GBl7{background-color:var(--dark-primary-color)}.dark .toolbar-module--icon--3lesc,.dark .toolbar-module--title--3e0YB{color:var(--dark-accent-text-color)}.icon-module--icon--2wDQu{display:inline-block;line-height:1}.icon-module--icon--2wDQu svg{fill:currentColor;height:1em;vertical-align:-.15em;width:1em}.authorCard-module--text-center--1lvKW{text-align:center}.authorCard-module--avatar--1s-zn>img{margin-bottom:0}.authorCard-module--avatar-circle--2ne8N{border-radius:50%;overflow:hidden}.authorCard-module--name--2KPL8{color:var(--accent-text-color);font-size:20px;padding-top:4px}.authorCard-module--dark--2N9hl .name{color:var(--dark-accent-text-color)}.authorCard-module--description--2LRcT{word-wrap:break-word;color:rgba(0,0,0,.5);font-size:15px;white-space:normal;word-break:break-all}.sidebar-module--overlay--3AuUC{background:rgba(0,0,0,.4);bottom:0;left:0;position:fixed;right:0;top:0;z-index:500}.sidebar-module--sidebar--2nyyN{background-color:var(--accent-background-color);bottom:0;box-sizing:border-box;height:calc(100vh - 58px);left:0;overflow-x:hidden;overflow-y:auto;position:fixed;white-space:nowrap;width:calc(100% - 64px);will-change:transform;z-index:1000}.dark .sidebar-module--sidebar--2nyyN{background-color:var(--dark-accent-background-color)}.sidebar-module--open--1ehas{-webkit-transform:translateX(0)!important;transform:translateX(0)!important}.sidebar-module--close--2qQlt{box-shadow:none!important;-webkit-transform:translateX(-280px);transform:translateX(-280px)}@-moz-document url-prefix(){.sidebar-module--sidebar--2nyyN{height:calc(100vh - 67px)}}@media (min-width:992px){.sidebar-module--sidebar--2nyyN{max-width:280px}.sidebar-module--sidebar-shadow--1vEHZ{box-shadow:1px 2px 0 1px var(--divider-color)}.dark .sidebar-module--sidebar-shadow--1vEHZ{box-shadow:1px 2px 0 1px var(--dark-divider-color)}}@media (max-width:992px){.sidebar-module--sidebar--2nyyN{height:100vh;max-width:280px;top:0}}@media (max-width:600px){.sidebar-module--sidebar--2nyyN{max-width:300px}.sidebar-module--close--2qQlt{-webkit-transform:translateX(-300px);transform:translateX(-300px)}}.contacts-module--contacts--Q1-I8{display:flex;flex-wrap:wrap;justify-content:center;padding:0 16px 8px}.contacts-module--contacts--Q1-I8>a>i{font-size:20px;padding-right:8px}.footer-module--footer--19rwW{color:#555;font-size:12px;line-height:1.5}.footer-module--footer--19rwW>div{text-align:center}.dark .footer-module--footer--19rwW{color:var(--dark-text-color)!important}:root{--primary-color:#51b26d;--background-color:#e0e0e0;--text-color:#555;--accent-background-color:#eee;--accent-text-color:#212121;--divider-color:#bdbdbd80;--dark-primary-color:#212121;--dark-accent-color:#9e9e9e;--dark-background-color:#616161;--dark-accent-background-color:#757575;--dark-text-color:#333;--dark-accent-text-color:#eee;--dark-divider-color:#42424238;--post-info-text-color:#555;--post-title-color:#444;--dark-post-info-text-color:#333;--dark-post-title-color:#212121}body{background-color:var(--background-color);overflow-x:hidden}body ::-webkit-scrollbar{background:#8e535300;height:5px;width:5px}body ::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2)}.global-transition div,body{transition:all .4s cubic-bezier(.645,.045,.355,1) 0s}body[class^=dark]{background-color:var(--dark-background-color)!important}.body-locked{overflow:hidden}.divider{background-color:var(--divider-color);display:table;height:1px;margin-bottom:6px;position:relative;vertical-align:middle;width:100%}.dark .divider{background-color:var(--dark-divider-color)}.dark a:focus,.dark a:hover{color:#999!important;text-decoration:underline!important}.lazyload,.lazyloading{background-color:#9e9e9e;height:auto;opacity:1;width:auto}.lazyloaded{height:auto;opacity:1;transition:opacity .3s;width:auto}.medium-zoom-overlay{z-index:1002}.medium-zoom-image--opened{z-index:1003}.post-body{color:#555;line-height:2;margin:20px;padding-bottom:20px}.post-body h2,.post-body h3,.post-body h4,.post-body h5,.post-body h6{border-bottom:none;border-left:4px solid #51b26d;margin-bottom:10px;margin-left:0;padding-left:32px}.post-body p{word-wrap:break-word;margin:0 0 20px;word-break:normal}.post-body img{height:auto;margin:1%;max-width:65%;min-width:50px}@media(max-width:900px){.post-body img{max-width:100%}}.post-body a{color:#2196f3!important;text-decoration:none;word-break:break-all}.post-body a:active,a:focus,a:hover{color:#51b26d!important;text-decoration:underline!important}.post-body blockquote{background-color:#e3f2fd;border-left:4px solid #1098ad;border-radius:3px;color:#2e405b;margin:0 0 20px;padding:0 0 0 10px}.post-body pre{margin:1% auto 20px}.post-body pre code{background-color:#2b2b2b;display:block;overflow:auto;padding:1%}.post-body .code-line>code>span{display:inline}.post-body hr{background-color:#555;border:none;height:1px}.post-body table{border-collapse:collapse;border-spacing:0;font-size:.875em;margin:0 0 20px;width:100%}.post-body tbody tr:nth-of-type(odd){background:#f9f9f9}.post-body tbody tr:hover{background-color:#999!important}.post-body th,td{border:1px solid #777;font-weight:400;padding:8px;text-align:left;vertical-align:middle}.dark .post-body{color:#333!important}.dark .post-body a{color:#222!important}.dark .post-body a:active,.dark .post-body a:focus,.dark .post-body a:hover{color:#111!important;text-decoration:underline!important}.dark .post-body h2,.dark .post-body h3,.dark .post-body h4,.dark .post-body h5,.dark .post-body h6{border-left:4px solid #111!important}.dark blockquote{background-color:#e3f2fd2c;border-left:4px solid #616161!important;color:#bdbdbd}.dark .post-body hr{background-color:#555}.dark .post-body tbody tr:nth-of-type(odd){background:#555}.dark .post-body tbody tr:hover{background-color:hsla(0,0%,60%,.5)!important}.dark .post-body th,td{border:1px solid #999}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.yoshino-icon{display:inline-block;line-height:1}.yoshino-icon>*{border:0;display:block;margin:0;padding:0;vertical-align:middle}.yoshino-icon svg{fill:currentColor;height:1em;vertical-align:-.15em;width:1em}.yoshino-menu.yoshino-menu-vertical .yoshino-menu-item:after{content:"";display:inline-block;height:0;position:absolute;right:-1px;top:50%;transition:all .3s cubic-bezier(.645,.045,.355,1);width:0}.yoshino-menu.yoshino-menu-vertical .yoshino-menu-item-active{background:#eef7f0}.yoshino-menu.yoshino-menu-vertical .yoshino-menu-item-active:after{background:#51b26d;height:100%;top:0;width:3px}.yoshino-menu.yoshino-menu-horizontal{border-right:none}.yoshino-menu.yoshino-menu-horizontal .yoshino-sub-menu,.yoshino-menu.yoshino-menu-horizontal>.yoshino-menu-item{display:inline-block}.yoshino-menu.yoshino-menu-horizontal .yoshino-menu-item,.yoshino-menu.yoshino-menu-horizontal .yoshino-sub-menu-title{padding:0 20px}.yoshino-menu.yoshino-menu-horizontal .yoshino-menu-item:after{bottom:-1px;content:"";display:inline-block;height:0;left:50%;position:absolute;transition:all .3s cubic-bezier(.645,.045,.355,1);width:0}.yoshino-menu.yoshino-menu-horizontal .yoshino-menu-item-active:after{background:#51b26d;height:3px;left:0;width:100%}.yoshino-sub-menu-pop-list{background:#fff;border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,.15);margin-top:1px}.yoshino-sub-menu-pop-list .yoshino-menu-item,.yoshino-sub-menu-pop-list .yoshino-menu-item-group-title,.yoshino-sub-menu-pop-list .yoshino-sub-menu-title{padding:0 16px}.yoshino-sub-menu-pop-list .yoshino-menu-item-group .yoshino-sub-menu-title,.yoshino-sub-menu-pop-list .yoshino-menu-item-group>.yoshino-menu-item{padding-left:0 16px 0 28px}.yoshino-sub-menu-pop-list .yoshino-sub-menu{position:relative}.yoshino-sub-menu-pop-list .yoshino-sub-menu-title{overflow:visible;position:relative}.yoshino-sub-menu-pop-list .yoshino-sub-menu-container{overflow:visible}.yoshino-sub-menu-pop-list .yoshino-sub-menu-child-menu-container{left:100%;padding-left:10px;position:absolute;top:0}.yoshino-sub-menu-pop-list .yoshino-sub-menu-child-menu{background:#fff;border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,.15)}.yoshino-sub-menu-pop-list .yoshino-menu-item-active{background:#eef7f0}.yoshino-menu{border-right:1px solid #e8e8e8}.yoshino-sub-menu *{transition:all .3s cubic-bezier(.645,.045,.355,1)}.yoshino-sub-menu-title{cursor:pointer;font-size:14px;height:40px;line-height:40px;margin:4px 0;overflow:hidden;padding-right:40px;position:relative;text-overflow:ellipsis;white-space:nowrap}.yoshino-sub-menu-title:hover{color:#51b26d}.yoshino-sub-menu-disabled .yoshino-sub-menu-title{color:#b8b8b8;cursor:not-allowed}.yoshino-sub-menu-disabled .yoshino-sub-menu-title:hover{color:#b8b8b8}.yoshino-sub-menu-container{overflow:hidden}.yoshino-sub-menu-icon{font-size:14px}.yoshino-sub-menu-hidden .yoshino-sub-menu-icon{-webkit-transform:translateY(-50%) rotate(180deg);transform:translateY(-50%) rotate(180deg)}.yoshino-sub-menu-icon{font-size:12px;position:absolute;right:15px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.yoshino-sub-menu:first-child .yoshino-sub-menu-title{margin-top:0}.yoshino-menu-item-group-title{color:#b8b8b8;font-size:14px;height:40px;line-height:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.yoshino-menu-item-group:first-child{margin-top:0}.yoshino-menu-item{cursor:pointer;font-size:14px;height:40px;line-height:40px;margin:4px 0;overflow:hidden;position:relative;text-overflow:ellipsis;transition:all .3s cubic-bezier(.645,.045,.355,1);white-space:nowrap}.yoshino-menu-item:hover:not(.yoshino-menu-item-disabled){color:#51b26d}.yoshino-menu-item-disabled{color:#b8b8b8;cursor:not-allowed}.yoshino-menu-item-active{color:#51b26d}.yoshino-menu-item:first-child{margin-top:0}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}to{-webkit-transform:rotate(1turn);transform:rotate(1turn);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}to{-webkit-transform:rotate(1turn);transform:rotate(1turn);-webkit-transform-origin:50% 50%;transform-origin:50% 50%}}.yoshino-button{background-color:#fff;border:1px solid #d9d9d9;border-radius:4px;cursor:pointer;display:inline-block;font-size:14px;height:32px;outline:0;padding:0 15px;transition:all .3s cubic-bezier(.645,.045,.355,1);-webkit-user-select:none;-ms-user-select:none;user-select:none}.yoshino-button:disabled{background-color:#f7f7f7;color:#d9d9d9;cursor:not-allowed}.yoshino-button:disabled:focus,.yoshino-button:disabled:hover{border-color:#d9d9d9;color:#d9d9d9}.yoshino-button:focus,.yoshino-button:hover{border-color:#51b26d;color:#51b26d}.yoshino-button:active{color:#418e57}.yoshino-button-primary{background-color:#51b26d;border-color:#51b26d;color:#fff}.yoshino-button-primary:focus,.yoshino-button-primary:hover{background-color:#62ba7c;color:#fff}.yoshino-button-primary:active{background-color:#418e57}.yoshino-button-dashed{border-style:dashed;color:#51b26d}.yoshino-button-danger{background-color:#f7f7f7;color:#f04134}.yoshino-button-danger:focus,.yoshino-button-danger:hover{background-color:#f04134;border-color:#f04134;color:#fff}.yoshino-button-danger:active{background-color:#d73435;border-color:#d73435}.yoshino-button-size-small{border-radius:4px;font-size:12px;height:24px;padding:0 7px}.yoshino-button-size-large{font-size:14px;height:40px;padding:0 15px}.yoshino-button-ghost{color:#fff}.yoshino-button-ghost,.yoshino-button-ghost:focus,.yoshino-button-ghost:hover{background-color:transparent}.yoshino-button-ghost.yoshino-button-primary{color:#51b26d}.yoshino-button-ghost.yoshino-button-danger{border-color:#f04134;color:#f04134}.yoshino-button-ghost.yoshino-button-danger:active{border-color:#d73435;color:#d73435}.yoshino-button-icon{align-items:center;display:flex;justify-content:center}.yoshino-button-icon i{display:block}.yoshino-button-shape-circle{border-radius:28px;font-size:14px;height:28px;padding:0;width:28px}.yoshino-button-load{-webkit-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite}.yoshino-button-container{align-content:center;display:flex;justify-content:center}.yoshino-pop{outline:0;position:absolute}.yoshino-pop :focus{outline:0}.yoshino-tooltip{position:relative;transition:opacity .3s cubic-bezier(.645,.045,.355,1)}.yoshino-tooltip-arrow{border-color:transparent;border-style:solid;height:0;position:absolute;width:0}.yoshino-tooltip-content{background:rgba(0,0,0,.75);border-radius:4px;color:#fff;font-size:12px;padding:5px;position:relative;white-space:nowrap}.yoshino-tooltip-top .yoshino-tooltip-arrow,.yoshino-tooltip-topLeft .yoshino-tooltip-arrow,.yoshino-tooltip-topRight .yoshino-tooltip-arrow{border-top-color:rgba(0,0,0,.75);border-width:5px 5px 0;bottom:3px}.yoshino-tooltip-top .yoshino-tooltip-content,.yoshino-tooltip-topLeft .yoshino-tooltip-content,.yoshino-tooltip-topRight .yoshino-tooltip-content{top:-8px}.yoshino-tooltip-bottomLeft>.yoshino-tooltip-arrow,.yoshino-tooltip-topLeft>.yoshino-tooltip-arrow{left:8px}.yoshino-tooltip-bottom>.yoshino-tooltip-arrow,.yoshino-tooltip-top>.yoshino-tooltip-arrow{left:50%;-webkit-transform:translate(-50%);transform:translate(-50%)}.yoshino-tooltip-bottomRight>.yoshino-tooltip-arrow,.yoshino-tooltip-topRight>.yoshino-tooltip-arrow{right:8px}.yoshino-tooltip-bottom .yoshino-tooltip-arrow,.yoshino-tooltip-bottomLeft .yoshino-tooltip-arrow,.yoshino-tooltip-bottomRight .yoshino-tooltip-arrow{border-bottom-color:rgba(0,0,0,.75);border-width:0 5px 5px;top:3px}.yoshino-tooltip-bottom .yoshino-tooltip-content,.yoshino-tooltip-bottomLeft .yoshino-tooltip-content,.yoshino-tooltip-bottomRight .yoshino-tooltip-content{bottom:-8px}.yoshino-tooltip-left .yoshino-tooltip-arrow,.yoshino-tooltip-leftBottom .yoshino-tooltip-arrow,.yoshino-tooltip-leftTop .yoshino-tooltip-arrow{border-left-color:rgba(0,0,0,.75);border-width:5px 0 5px 5px;right:3px}.yoshino-tooltip-left .yoshino-tooltip-content,.yoshino-tooltip-leftBottom .yoshino-tooltip-content,.yoshino-tooltip-leftTop .yoshino-tooltip-content{left:-8px}.yoshino-tooltip-left>.yoshino-tooltip-arrow,.yoshino-tooltip-right>.yoshino-tooltip-arrow{top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.yoshino-tooltip-leftTop>.yoshino-tooltip-arrow,.yoshino-tooltip-rightTop>.yoshino-tooltip-arrow{top:8px}.yoshino-tooltip-leftBottom>.yoshino-tooltip-arrow,.yoshino-tooltip-rightBottom>.yoshino-tooltip-arrow{bottom:8px}.yoshino-tooltip-right .yoshino-tooltip-arrow,.yoshino-tooltip-rightBottom .yoshino-tooltip-arrow,.yoshino-tooltip-rightTop .yoshino-tooltip-arrow{border-right-color:rgba(0,0,0,.75);border-width:5px 5px 5px 0;left:3px}.yoshino-tooltip-right .yoshino-tooltip-content,.yoshino-tooltip-rightBottom .yoshino-tooltip-content,.yoshino-tooltip-rightTop .yoshino-tooltip-content{right:-8px}.yoshino-tooltip-appear{display:block;opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.yoshino-tooltip-active-appear{display:block;-webkit-transform:scale(1);transform:scale(1)}.yoshino-tooltip-active-enter,.yoshino-tooltip-enter{display:block;-webkit-transform:scale(.8);transform:scale(.8)}.yoshino-tooltip-done-enter,.yoshino-tooltip-exit{display:block;-webkit-transform:scale(1);transform:scale(1)}.yoshino-tooltip-active-exit{display:block;-webkit-transform:scale(.8);transform:scale(.8)}.yoshino-tooltip-done-exit{display:none;-webkit-transform:scale(.8);transform:scale(.8)}.yoshino-pagination{-webkit-user-select:none;-ms-user-select:none;user-select:none}.yoshino-pagination-item{border:1px solid #d9d9d9;border-radius:4px;cursor:pointer;display:inline-block;font-size:14px;height:32px;line-height:32px;margin-right:8px;min-width:32px;text-align:center}.yoshino-pagination-item-active,.yoshino-pagination-item:hover{border-color:#51b26d;color:#51b26d}.yoshino-pagination-item-more{border:none}.yoshino-pagination-item:last-child{margin-right:0}.yoshino-pagination-footer,.yoshino-pagination-header{padding:0 5px}*,:after,:before{box-sizing:border-box;margin:0;padding:0}body{font-family:Monospaced Number,Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif}iframe,img,input,select,textarea{border:0;outline:0}input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}button:focus,input:focus,select:focus,textarea:focus{outline:0}a,a:active,a:hover,a:link,a:visited{color:inherit;text-decoration:none}::-ms-clear{display:none}::-webkit-search-cancel-button,::-webkit-search-decoration,::-webkit-search-results-button,::-webkit-search-results-decoration{display:none}li,ul{list-style:none}.yoshino-menu{border-right:0!important}.dark .yoshino-menu.yoshino-menu-vertical .yoshino-menu-item-active{--dark-accent-color:#9e9e9e80;background:var(--dark-accent-color)!important}.dark .yoshino-menu.yoshino-menu-vertical .yoshino-menu-item-active:after{background:#cfbbbb!important}.dark .yoshino-menu-item-active,.dark .yoshino-menu-item:hover:not(.yoshino-menu-item-disabled){color:var(--dark-accent-text-color)!important}.dark .yoshino-pagination-item-active,.dark .yoshino-pagination-item:hover{border-color:#222;color:#222}.post-module--post-card--AAnsR{margin:25px;max-width:1200px;width:100%}.post-module--post--34YDX{position:relative}.post-module--comment--2LekW,.post-module--post--34YDX{background-color:var(--accent-background-color);box-shadow:0 2px 8px rgba(0,0,0,.15)}.post-module--comment--2LekW{padding:10px}.dark .post-module--comment--2LekW,.dark .post-module--post--34YDX{background-color:var(--dark-accent-background-color)!important}.archives-module--archives-card--2Z37N{background-color:var(--accent-background-color);box-shadow:0 2px 8px rgba(0,0,0,.15);margin:25px;max-width:1200px;padding:8px;width:100%}.archives-module--archives-card--2Z37N>h1{color:var(--accent-text-color);margin-bottom:8px}.archives-module--archives-list--AKc4Y ul{padding-left:8px}.archives-module--archives-list--AKc4Y>ul>li li{border-bottom:1px dashed #ccc;list-style:disc;margin-left:32px;padding:4px}.archives-module--archives-list--AKc4Y time{margin-right:8px}.dark .archives-module--archives-card--2Z37N{background-color:var(--dark-accent-background-color)!important}.dark .archives-module--archives-list--AKc4Y>ul>li li{border-bottom:1px dashed #999}.link-module--link-card--36edS{background-color:var(--accent-background-color);box-shadow:0 2px 8px rgba(0,0,0,.15);margin:25px;max-width:1200px;padding:8px;width:100%}.link-module--link-card--36edS>h1{color:var(--accent-text-color);margin-bottom:8px}.link-module--link-list--3LT-r{display:flex;flex-wrap:wrap;margin:25px}.link-module--link-item--bAliS{height:150px;margin:0 0 30px;text-align:center;width:12.5%}.link-module--link-item--bAliS img{height:100px;width:100px}.link-module--link-item--bAliS h4{color:var(--text-color)}.link-module--link-item--bAliS p{color:#666;font-size:12px}.dark .link-module--link-card--36edS{background-color:var(--dark-accent-background-color)!important}.dark .link-module--link-item--bAliS h4{color:var(--dark-text-color)!important}.dark .link-module--link-item--bAliS p{color:#444}@media(min-width:0px){.link-module--link-item--bAliS{width:100%}}@media(min-width:350px){.link-module--link-item--bAliS{width:50%}}@media(min-width:600px){.link-module--link-item--bAliS{width:25%}}@media(min-width:1000px){.link-module--link-item--bAliS{width:12.5%}}.index-module--index--37LS8{margin:24px;max-width:1200px;width:100%}.index-module--pagination--2V1v2{margin-bottom:30px;text-align:center}.index-module--tag-name--nkpb0{display:block;font-size:30px;margin:24px}.postHead-module--title--2tgEC{color:var(--post-title-color);font-size:25px;font-weight:700;padding:8px;text-align:center}.dark .postHead-module--title--2tgEC{color:var(--dark-post-title-color)!important}.postInfo-module--post-info--3v5BP{color:var(--post-info-text-color);font-size:12px;text-align:center}.postInfo-module--post-info--3v5BP>span{margin:0 4px}.dark .postInfo-module--post-info--3v5BP{color:var(--dark-post-info-text-color)!important}.postInfo-module--post-info--3v5BP>span>i{color:var(--primary-color);font-size:16px}.dark .postInfo-module--post-info--3v5BP>span>i{color:var(--dark-primary-color)!important}.postItem-module--post-item--2QpdO{background-color:var(--accent-background-color);box-shadow:0 2px 8px rgba(0,0,0,.15);margin-bottom:40px;width:100%}.postItem-module--more-button--1mvIw{padding-bottom:16px;text-align:center}.postItem-module--more-button--1mvIw>button{background-color:#2196f3!important;border-color:#2196f3!important;color:#fff}.dark .postItem-module--more-button--1mvIw>button{background-color:#222!important;border-color:#222!important;color:#fff}.dark .postItem-module--post-item--2QpdO{background-color:var(--dark-accent-background-color)!important}.toc-wrap ol{font-size:13px;list-style:none;margin:0;overflow-x:hidden;overflow-y:auto;padding:0 2px 5px 10px;text-align:left}.toc-wrap ol>ol{padding-left:0}.toc-wrap ol a{border-bottom-color:#ccc;color:#0593d3;text-decoration:none;transition-delay:0s;transition-duration:.2s;transition-property:all;transition-timing-function:ease-in-out}.toc-wrap .nav-item{line-height:1.8;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.toc-wrap .nav .active>a{border-bottom-color:#51b26d;color:#51b26d}.toc-wrap .nav .active-current>a,.toc-wrap .nav .active-current>a:hover{color:#51b26d}.toc-wrap .nav .nav-child{display:none}.toc-wrap .nav .active-current>.nav-child,.toc-wrap .nav .active-current>.nav-child>.nav-item,.toc-wrap .nav .active>.nav-child{display:block}.dark .toc-wrap ol a{color:#999!important}.dark .toc-wrap .nav .active>a{border-bottom-color:#444!important;color:#333!important}.dark .toc-wrap .nav .active-current>a,.dark .toc-wrap .nav .active-current>a:hover{color:#333!important}.drag-module--drag--2rkNg{background-color:var(--background-color);border-radius:4px;box-shadow:0 0 10px rgba(0,0,0,.3);max-width:360px;position:fixed;right:calc(10vw - 100px);top:200px;transition:background-color .4s cubic-bezier(.645,.045,.355,1) 0s!important;width:100%;z-index:1001}.drag-module--title--1ckBs{cursor:move;height:auto;margin-bottom:6px;width:100%}.dark .drag-module--drag--2rkNg{background-color:var(--dark-background-color)!important}@media (max-width:992px){.drag-module--drag--2rkNg{display:none}}@media (min-width:1440px){.drag-module--drag--2rkNg{right:calc(20vw - 100px)}}@media (min-width:1920px){.drag-module--drag--2rkNg{right:calc(30vw - 100px)}}</style><meta name="generator" content="Gatsby 3.8.1"/><title data-react-helmet="true">Nginx webdav 在 Dolphin 上的一些坑 | Nworm</title><meta data-react-helmet="true" name="description" content="ps: 要不是webdav可以用cdn，我会用它？ 环境 服务器 OS: ubuntu 21.04 x64 Docker: v19.03.13, build cd8016b6bc ugeek/webdav:amd64-alpine (ed65583ea58e) nginx: v1.19.7 客户端 OS: Archlinux Dolphin: v21.04.0"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:description" content="ps: 要不是webdav可以用cdn，我会用它？ 环境 服务器 OS: ubuntu 21.04 x64 Docker: v19.03.13, build cd8016b6bc ugeek/webdav:amd64-alpine (ed65583ea58e) nginx: v1.19.7 客户端 OS: Archlinux Dolphin: v21.04.0"/><link rel="sitemap" type="application/xml" href="/sitemap.xml/sitemap-index.xml"/><link rel="alternate" type="application/rss+xml" title="Nworm" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-70d8fed2626ee4cf73ff.js"/><link as="script" rel="preload" href="/framework-8dcaa89ad56a07169b97.js"/><link as="script" rel="preload" href="/app-3ea1d69a55c73fe045d7.js"/><link as="script" rel="preload" href="/e8cd86f8f80aa61ba39f4e3852b3c68c8d3a692a-c9d797aee625080cb59d.js"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-yoshino-src-templates-post-jsx-5be11a8a6b70def77787.js"/><link as="fetch" rel="preload" href="/page-data/post/nginx-webdav-dolphin-deken/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1528757306.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3042919606.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3159585216.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3741834850.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4209591199.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/847439237.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-transition"><header class="toolbar-module--toolbar--1GBl7 toolbar-module--toolbar-shadow--2zjJP"><i class="icon-module--icon--2wDQu toolbar-module--icon--3lesc" style="float:left"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></i><span class="toolbar-module--title--3e0YB">Nworm</span><i class="icon-module--icon--2wDQu toolbar-module--icon--3lesc" style="float:right"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18V6a6 6 0 010 12z"/></svg></i></header><div class="sidebar-module--sidebar--2nyyN sidebar-module--sidebar-shadow--1vEHZ sidebar-module--close--2qQlt" style="max-height:"><div></div><div style="min-height:calc(100% - 126px)"><div><div style="margin:16px"><div class="authorCard-module--avatar--1s-zn authorCard-module--text-center--1lvKW"><img class="authorCard-module--avatar-circle--2ne8N" src="//img.nworm.icu/avatar.jpg" width="100" height="100"/></div><div class="authorCard-module--text-center--1lvKW authorCard-module--name--2KPL8">nworm<br/><span class="authorCard-module--description--2LRcT"> <!-- -->一条咸鱼<!-- --> </span></div></div></div><div class="divider"></div><ul class="yoshino-menu yoshino-menu-vertical"><li class="yoshino-menu-item yoshino-menu-item-active" style="padding-left:24px;overflow:visible">主页</li><li class="yoshino-menu-item" style="padding-left:24px;overflow:visible">归档</li><li class="yoshino-menu-item" style="padding-left:24px;overflow:visible">关于</li><li class="yoshino-menu-item" style="padding-left:24px;overflow:visible">朋友</li></ul></div><div class="contacts-module--contacts--Q1-I8"><a href="https://github.com/1574242600" target="_blank" rel="noreferrer"><i class="icon-module--icon--2wDQu"><svg aria-hidden="true" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0a8 8 0 00-2.53 15.59c.4.07.55-.17.55-.38l-.01-1.49c-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.42 7.42 0 014 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48l-.01 2.2c0 .21.15.46.55.38A8.01 8.01 0 0016 8a8 8 0 00-8-8z"/></svg></i></a><a href="https://t.me/nworm1574" target="_blank" rel="noreferrer"><i class="icon-module--icon--2wDQu"><svg viewBox="0 0 300 300"><path d="M5.3 144.65l69.13 25.8 26.75 86.04a8.14 8.14 0 0012.93 3.9l38.53-31.42a11.5 11.5 0 0114.01-.39l69.5 50.46a8.15 8.15 0 0012.76-4.93l50.91-244.89a8.15 8.15 0 00-10.9-9.26L5.21 129.4c-7 2.7-6.94 12.61.08 15.25zm91.57 12.06l135.1-83.2c2.43-1.5 4.92 1.79 2.84 3.72L123.3 180.87a23.11 23.11 0 00-7.16 13.83l-3.8 28.15c-.5 3.75-5.78 4.13-6.82.49L90.93 172a13.6 13.6 0 015.94-15.3z"/></svg></i></a><a href="tencent://message/?uin=1574242600&amp;Site=&amp;Menu=yes" target="_blank" rel="noreferrer"><i class="icon-module--icon--2wDQu"><svg viewBox="0 0 31.62 31.62"><path d="M25.7 13.18a10.3 10.3 0 10-19.77 0C4.63 14.22-.4 18.74 1.67 24.6c0 0 1.75-.15 3.19-2.8.43 1.7 1.25 3.24 2.36 4.54-1.63.48-2.73 1.4-2.73 2.47 0 1.56 2.35 2.82 5.24 2.82 1.97 0 3.68-.59 4.57-1.44a11.47 11.47 0 003.01 0c.9.85 2.61 1.44 4.58 1.44 2.9 0 5.24-1.27 5.24-2.82 0-1.06-1.1-2-2.73-2.47 1.1-1.3 1.93-2.84 2.36-4.55 1.44 2.66 3.19 2.81 3.19 2.81 2.07-5.85-2.96-10.37-4.26-11.4z"/></svg></i></a></div><div class="divider"></div><footer class="footer-module--footer--19rwW"><div><span>博客已存活: </span>740天1小时20分15秒</div><div>© <!-- -->2021<!-- --> <!-- -->Nworm<!-- -->. <!-- -->Powered by<!-- --> <a href="//www.gatsbyjs.com/" target="_blank" rel="noreferrer">gatsby</a></div><div>Theme by  <a href="//github.com/1574242600/gatsby-theme-yoshino" target="_blank" rel="noreferrer">yoshino</a></div><div><span>Made with by <!-- -->nworm<!-- -->.</span> <span><a href="https://nworm.icu/sitemap.xml">sitemap</a></span> <span><a href="https://nworm.icu/rss.xml">rss</a></span></div></footer></div><div><div class="views"><div class="layout-module--pages--16eZ4" location="[object Object]"><div class="post-module--post-card--AAnsR"><div class="post-module--post--34YDX"><div><h2 class="postHead-module--title--2tgEC">Nginx webdav 在 Dolphin 上的一些坑</h2><div class="postInfo-module--post-info--3v5BP"><span><i class="icon-module--icon--2wDQu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M19 3h-1V1h-2v2H8V1H6v2H5a2 2 0 00-1.99 2L3 19a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/></svg></i> 发表于 <time dateTime="2021-05-22T23:50:00.000Z" itemProp="dateCreated datePublished">2021-5-22</time></span>|<span>预计阅读时长: 4 分钟</span>|<span>标签: <!-- --> <a href="/tag/Webdav">Webdav</a>, <a href="/tag/Nginx">Nginx</a>, <a href="/tag/Dolphin">Dolphin</a>, <a href="/tag/踩坑">踩坑</a></span></div></div><div class="post-body"><p>ps: 要不是webdav可以用cdn，我会用它？</p>

              <h2 id="环境">
                环境
              </h2>
              <h3 id="服务器">
                服务器
              </h3><ul>
<li>OS: ubuntu 21.04 x64</li>
<li>Docker: v19.03.13, build cd8016b6bc<ul>
<li>ugeek/webdav:amd64-alpine (ed65583ea58e)<ul>
<li>nginx: v1.19.7</li>
</ul>
</li>
</ul>
</li>
</ul>

              <h3 id="客户端">
                客户端
              </h3><ul>
<li>OS: Archlinux</li>
<li>Dolphin: v21.04.0<!--more-->

              <h2 id="坑">
                坑
              </h2>
              <h3 id="无法上传大文件状态码-413">
                无法上传大文件(状态码: 413)
              </h3>webdav 镜像本身没有这个问题，client_max_body_size 在主机配置文件中值为0。 </li>
</ul>
<p>我在另一台服务器使用 nginx 反代 webdav，但反代配置文件的 client_max_body_size 为 10M 导致无法上传大文件</p>

              <h4 id="原因">
                原因
              </h4><p>client_max_body_size 值过小</p>
<blockquote>
<p>Syntax:     client_max_body_size size;<br>Default:     client_max_body_size 1m;<br>Context:     http, server, location  </p>
<p>设置客户端请求正文的最大允许大小。如果请求中的大小超过配置值，则向客户端返回413(请求实体过大)错误。请注意浏览器无法正确显示此错误。将配置值设置为0将禁用对客户端请求正文大小的检查。</p>
</blockquote>

              <h4 id="解决方法">
                解决方法
              </h4><p>请检查 webdav 主机配置文件的 client_max_body_size，并设置适当的值</p>

              <h3 id="无法创建文件夹状态码-409">
                无法创建文件夹(状态码: 409)
              </h3>
              <h4 id="原因">
                原因
              </h4><p>创建文件夹时，Dolphin 发送的 MKCOL 请求，路径未以 &quot;/&quot; 结尾。nginx 对于这种行为直接返回 ”409 Conflict“</p>
<p><a href="https://github.com/nginx/nginx/blob/5e5fa2e9e57b713e445b1737005ff6a202bda8ad/src/http/modules/ngx_http_dav_module.c#L504-L508">ngx_http_dav_module.c (504-508)</a></p>
<pre><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>data<span class="token punctuation">[</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">ngx_log_error</span><span class="token punctuation">(</span>NGX_LOG_ERR<span class="token punctuation">,</span> r<span class="token operator">-></span>connection<span class="token operator">-></span>log<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
               <span class="token string">"MKCOL can create a collection only"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> NGX_HTTP_CONFLICT<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>至于请求路径是否该以 &quot;/&quot; 结尾，<a href="https://datatracker.ietf.org/doc/html/rfc2518">rfc2518</a> 中好像没有规定，不过在<a href="https://datatracker.ietf.org/doc/html/rfc2518#section-8.3.3">示例</a>里路径以 &quot;/&quot; 结尾。  </p>

              <h4 id="解决方法">
                解决方法
              </h4><p>方法1: 配置文件<br>使用 rewrite 重写路径  </p>
<pre><code class="language-nginx"><span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_method</span> = MKCOL)</span> <span class="token punctuation">{</span> 
    <span class="token directive"><span class="token keyword">rewrite</span> ^(.*[^/])$ <span class="token variable">$1</span>/ break</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
<p>方法2: 删除相关代码，重新编译<br>删除 ngx_http_dav_module.c 中相关的代码，重新编译。</p>

              <h3 id="无法删除文件夹状态码-409">
                无法删除文件夹(状态码: 409)
              </h3>
              <h4 id="原因">
                原因
              </h4><p>删除文件夹时，Dolphin 发送的 DELETE 请求，目录的路径未以 &quot;/&quot; 结尾。<br>nginx 会先判断是否为文件夹，如果是，就再判断路径是否以 &quot;/&quot; 结尾。不以&quot;/&quot;结尾返回 ”409 Conflict“</p>
<p><a href="https://github.com/nginx/nginx/blob/5e5fa2e9e57b713e445b1737005ff6a202bda8ad/src/http/modules/ngx_http_dav_module.c#L357-L364">ngx_http_dav_module.c (357-364)</a></p>
<pre><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ngx_is_dir</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>data<span class="token punctuation">[</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">ngx_log_error</span><span class="token punctuation">(</span>NGX_LOG_ERR<span class="token punctuation">,</span>r<span class="token operator">-></span>connection<span class="token operator">-></span>log<span class="token punctuation">,</span> NGX_EISDIR<span class="token punctuation">,</span>
                        <span class="token string">"DELETE \"%s\" failed"</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> NGX_HTTP_CONFLICT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>

              <h4 id="解决方法">
                解决方法
              </h4><p>方法1: 配置文件<br>使用 rewrite 重写路径  </p>
<pre><code class="language-nginx"><span class="token directive"><span class="token keyword">if</span> (-d <span class="token variable">$request_filename</span>)</span> <span class="token punctuation">{</span> 
    <span class="token directive"><span class="token keyword">rewrite</span> ^(.*[^/])$ <span class="token variable">$1</span>/ break</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
<p>方法2: 删除相关代码，重新编译<br>删除 ngx_http_dav_module.c 中相关的代码，重新编译。</p>

              <h3 id="无法复制移动文件夹状态码-409">
                无法复制/移动文件夹(状态码: 409)
              </h3>
              <h4 id="原因">
                原因
              </h4><p>没错，还tm是&quot;/&quot;的问题。。。  </p>
<p>复制/移动文件夹时发送的 COPY/MOVE 请求，目录的路径和 Destination 头未以&quot;/&quot;结尾。Nginx 返回 409  </p>
<p>ps: 复制文件夹的话 Dolphin 问题不大，因为它不会直接发送复制文件夹的请求。它会先创建文件夹，再复制文件。</p>
<p><a href="https://github.com/nginx/nginx/blob/5e5fa2e9e57b713e445b1737005ff6a202bda8ad/src/http/modules/ngx_http_dav_module.c#L637-L646">ngx_http_dav_module.c (637-646)</a></p>
<pre><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>data<span class="token punctuation">[</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'/'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>last <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token operator">||</span> <span class="token punctuation">(</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>data<span class="token punctuation">[</span>r<span class="token operator">-></span>uri<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'/'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span>last <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">ngx_log_error</span><span class="token punctuation">(</span>NGX_LOG_ERR<span class="token punctuation">,</span> r<span class="token operator">-></span>connection<span class="token operator">-></span>log<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token string">"both URI \"%V\" and \"Destination\" URI \"%V\" "</span>
                    <span class="token string">"should be either collections or non-collections"</span><span class="token punctuation">,</span>
                    <span class="token operator">&amp;</span>r<span class="token operator">-></span>uri<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dest<span class="token operator">-></span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> NGX_HTTP_CONFLICT<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>

              <h4 id="解决方法">
                解决方法
              </h4><p>适用于 Dolphin 或类似机制的客户端无法复制文件夹的解决方法同 <a href="#">无法创建文件夹</a></p>
<p>通用:<br>方法1: 配置文件<br>使用 rewrite 和 more_set_input_headers(需要 headers-more-nginx-module) 重写路径和 Destination 头</p>
<pre><code class="language-nginx"><span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_copy_or_move</span> <span class="token number">0</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_dir</span> <span class="token number">0</span></span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">if</span> (-d <span class="token variable">$request_filename</span>)</span> <span class="token punctuation">{</span> 
    <span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_dir</span> <span class="token number">1</span></span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_method</span> = COPY)</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_copy_or_move</span> <span class="token number">1</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_method</span> = MOVE)</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_copy_or_move</span> <span class="token number">1</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">set</span> <span class="token variable">$is_rewrite</span> <span class="token string">"<span class="token variable">${is_dir}</span><span class="token variable">${is_copy_or_move}</span>"</span></span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$is_rewrite</span> = 11)</span> <span class="token punctuation">{</span> 
    <span class="token directive"><span class="token keyword">more_set_input_headers</span> <span class="token string">'Destination: <span class="token variable">$http_destination/</span>'</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^(.*[^/])$ <span class="token variable">$1</span>/ break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>方法2: 删除相关代码，重新编译<br>删除 ngx_http_dav_module.c 中相关的代码，重新编译。</p>
<!-- todo
## 不显示含非英文字符文件及文件夹
这个我不确定，不过大概率是编码的问题。
-->


              <h2 id="成果">
                成果
              </h2><p>这是修复以上问题的 docker 镜像
<a href="https://hub.docker.com/r/1574242600/webdav">https://hub.docker.com/r/1574242600/webdav</a></p>

              <h2 id="参考">
                参考
              </h2><ol>
<li><a href="http://netlab.dhis.org/wiki/ru:software:nginx:webdav">Nginx and Microsoft Windows WebClient (WebDav)</a>  / <a href="https://web.archive.org/web/20201026211658/http://netlab.dhis.org/wiki/ru:software:nginx:webdav">Archived</a></li>
<li><a href="https://cetteup.com/36/cant-create-or-delete-directories-on-an-nginx-webdav-server-here-is-how-to-fix-that/">Can’t create or delete directories on an NGINX WebDAV server? Here’s how to fix that!</a> / <a href="https://web.archive.org/web/20210521142218/https://cetteup.com/36/cant-create-or-delete-directories-on-an-nginx-webdav-server-here-is-how-to-fix-that/">Archived</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc2518">rfc2518</a></li>
</ol>
</div></div><div class="post-module--comment--2LekW"><div id="disqus_thread"><div> loading...</div></div></div></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/nginx-webdav-dolphin-deken/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-449ad1ef2c201a2585b7.js"],"app":["/app-3ea1d69a55c73fe045d7.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-c3c6e29b369bd2f51e84.js"],"component---node-modules-gatsby-theme-yoshino-src-pages-404-jsx":["/component---node-modules-gatsby-theme-yoshino-src-pages-404-jsx-02767214fd5eb6b3613d.js"],"component---node-modules-gatsby-theme-yoshino-src-pages-about-jsx":["/component---node-modules-gatsby-theme-yoshino-src-pages-about-jsx-e1104846e17eb6825e4c.js"],"component---node-modules-gatsby-theme-yoshino-src-pages-archives-jsx":["/component---node-modules-gatsby-theme-yoshino-src-pages-archives-jsx-538c6c7a7fea46272f63.js"],"component---node-modules-gatsby-theme-yoshino-src-pages-link-jsx":["/component---node-modules-gatsby-theme-yoshino-src-pages-link-jsx-4b54604d9e1e4b9a9b74.js"],"component---node-modules-gatsby-theme-yoshino-src-templates-index-jsx":["/component---node-modules-gatsby-theme-yoshino-src-templates-index-jsx-7d8cd1179bc4423985a2.js"],"component---node-modules-gatsby-theme-yoshino-src-templates-post-jsx":["/component---node-modules-gatsby-theme-yoshino-src-templates-post-jsx-5be11a8a6b70def77787.js"],"component---node-modules-gatsby-theme-yoshino-src-templates-tag-jsx":["/component---node-modules-gatsby-theme-yoshino-src-templates-tag-jsx-648344673e0a727eea4f.js"]};/*]]>*/</script><script src="/polyfill-449ad1ef2c201a2585b7.js" nomodule=""></script><script src="/component---node-modules-gatsby-theme-yoshino-src-templates-post-jsx-5be11a8a6b70def77787.js" async=""></script><script src="/e8cd86f8f80aa61ba39f4e3852b3c68c8d3a692a-c9d797aee625080cb59d.js" async=""></script><script src="/app-3ea1d69a55c73fe045d7.js" async=""></script><script src="/framework-8dcaa89ad56a07169b97.js" async=""></script><script src="/webpack-runtime-70d8fed2626ee4cf73ff.js" async=""></script></body></html>