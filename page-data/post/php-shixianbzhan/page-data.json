{"componentChunkName":"component---node-modules-gatsby-theme-yoshino-src-templates-post-jsx","path":"/post/php-shixianbzhan/","result":{"data":{"markdownRemark":{"frontmatter":{"date":"2019-12-25T20:00:00.000Z","tags":["php"],"title":"[php]实现b站登录","update":null},"timeToRead":5,"navHtml":"<ol class=\"nav\"><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#返回示例\"><span class=\"nav-number\">1.</span> <span class=\"nav-text\">返回示例</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#签名sign生成方式：\"><span class=\"nav-number\">2.</span> <span class=\"nav-text\">签名(sign)生成方式：</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#password-生成方式\"><span class=\"nav-number\">3.</span> <span class=\"nav-text\">password 生成方式</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#demo\"><span class=\"nav-number\">4.</span> <span class=\"nav-text\">demo</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#源码\"><span class=\"nav-number\">5.</span> <span class=\"nav-text\">源码</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#关于验证码的问题\"><span class=\"nav-number\">6.</span> <span class=\"nav-text\">关于验证码的问题</span></a></li><li class=\"nav-item nav-level-3\"><a class=\"nav-link\" href=\"#坑\"><span class=\"nav-number\">7.</span> <span class=\"nav-text\">坑</span></a></li></ol>","excerpt":"https://blog.kaaass.net/archives/947 在网上无聊瞎逛时，找到了这位大佬的文章\n里面给出了ak，sk ，万分感激","html":"<blockquote>\n<p><a href=\"https://blog.kaaass.net/archives/947\">https://blog.kaaass.net/archives/947</a></p>\n</blockquote>\n<hr>\n<p>在网上无聊瞎逛时，找到了这位大佬的文章\n里面给出了ak，sk ，万分感激 </p>\n<!--more-->\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Device: android</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description: 普通版</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AppKey: 1d8b6e7d45233436</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SecretKey: 560c52ccd288fed045859ed18bffd973</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Device: android_i</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description: 国际版</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AppKey: bb3101000e232e27</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SecretKey: 36efcfed79309338ced0380abd824ac1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Device: android_b</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description: 概念版</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AppKey: 07da50c9a0bf829f</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SecretKey: 25bdede4e1581c836cab73a48790ca6e</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Device: android_tv</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description: 电视版</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AppKey: 4409e2ce8ffd12b8</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SecretKey: 59b43e04ad6965f34319062b478f83dd</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Device: biliLink</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Description: 直播</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">AppKey: 37207f2beaebf8d7</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SecretKey: e988e794d4d4b6dd43bc0e89d6e90c43</span></span></code></pre>\n<p>（之前因为没ak，sk放弃了）\n那该死的小破站，居然还没有公开OAuth2 （<a href=\"https://passport.bilibili.com/register/third.html\">https://passport.bilibili.com/register/third.html</a>）\n那就只好用安卓客户端的api来玩了</p>\n<p><img src=\"https://i.loli.net/2019/12/25/9IkbpyWfH3ZaxQh.png\" alt=\"9IkbpyWfH3ZaxQh.png\">\n<img src=\"https://i.loli.net/2019/12/25/WIRCULzbswK2rZv.png\" alt=\"0OO07OWUEO{I_OU1L{VXQ2B.png\"></p>\n<p>分别请求了\n<a href=\"https://passport.bilibili.com/api/oauth2/getKey\">https://passport.bilibili.com/api/oauth2/getKey</a> 用于获取加密明文密码用的hash，公钥\n<a href=\"https://passport.bilibili.com/api/v2/oauth2/login\">https://passport.bilibili.com/api/v2/oauth2/login</a> 用于简单的获取用户的登录凭据（access_key、Cookie）\n下面看请求参数\n<img src=\"https://i.loli.net/2019/12/25/sInQoOAdxNuVt6W.png\" alt=\"JG)6MR77DWE@769{~AB1~YH.png\"></p>\n<table>\n<thead>\n<tr>\n<th>参数名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>appkey</td>\n<td>key</td>\n</tr>\n<tr>\n<td>build</td>\n<td>不知道</td>\n</tr>\n<tr>\n<td>mobi_app</td>\n<td>不知道</td>\n</tr>\n<tr>\n<td>platform</td>\n<td>不知道</td>\n</tr>\n<tr>\n<td>ts</td>\n<td>时间戳</td>\n</tr>\n<tr>\n<td>sign</td>\n<td>签名</td>\n</tr>\n</tbody>\n</table>\n<p>除了sign，没什么好讲的，第二个请求就多了两个参数 username ，password（重要）</p>\n<h3>返回示例</h3>\n<p><a href=\"https://passport.bilibili.com/api/oauth2/getKey\">https://passport.bilibili.com/api/oauth2/getKey</a></p>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"json\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">{</span><span class=\"mtk13\">&quot;ts&quot;</span><span class=\"mtk1\">:</span><span class=\"mtk7\">1577273591</span><span class=\"mtk1\">,   </span><span class=\"mtk5\">// 当前UNIX时间戳</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk13\">&quot;code&quot;</span><span class=\"mtk1\">:</span><span class=\"mtk7\">0</span><span class=\"mtk1\">,          </span><span class=\"mtk5\">//状态码</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk13\">&quot;data&quot;</span><span class=\"mtk1\">:{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk13\">&quot;hash&quot;</span><span class=\"mtk1\">:</span><span class=\"mtk19\">&quot;56e15708534f5973&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk5\">//哈希</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk13\">&quot;key&quot;</span><span class=\"mtk1\">:</span><span class=\"mtk19\">&quot;-----BEGIN PUBLIC KEY-----</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk19\"> \\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDjb4V7EidX/ym28t2ybo0U6t0n\\n6p4ej8VjqKHg100va6jkNbNTrLQqMCQCAYtXM</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk19\"> XXp2Fwkk6WR+12N9zknLjf+C9sx\\n/+l48mjUU8RqahiFD1XT/u2e0m2EN029OhCgkHx3Fc/KlFSIbak93EH/XlYis0w+\\nXl69GV6klz</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk19\"> gxW6d2xQIDAQAB\\n-----END PUBLIC KEY-----\\n&quot;</span><span class=\"mtk1\">   </span><span class=\"mtk5\">//公钥</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}}</span></span></span></code></pre>\n<p><a href=\"https://passport.bilibili.com/api/v2/oauth2/login\">https://passport.bilibili.com/api/v2/oauth2/login</a></p>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"json\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk13\">&quot;ts&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk7\">1577278563</span><span class=\"mtk1\">, </span><span class=\"mtk5\">// 当前UNIX时间戳</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk13\">&quot;code&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk7\">0</span><span class=\"mtk1\">,  </span><span class=\"mtk5\">// 状态码</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk13\">&quot;data&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t</span><span class=\"mtk13\">&quot;status&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk7\">0</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t</span><span class=\"mtk13\">&quot;token_info&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;mid&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk7\">1</span><span class=\"mtk1\">, </span><span class=\"mtk5\">// 该用户的mid</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;access_token&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk19\">&quot;1234567890abcde1234567890abc&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk5\">// 该用户的access_key</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;refresh_token&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk19\">&quot;1234567890abcde1234567890abc&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk5\">// 该用户的refresh_token</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;expires_in&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk7\">2592000</span><span class=\"mtk1\">             </span><span class=\"mtk5\">// 过期时间戳</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t},</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t</span><span class=\"mtk13\">&quot;cookie_info&quot;</span><span class=\"mtk1\">: {     </span><span class=\"mtk5\">// 该用户Cookie凭据</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;cookies&quot;</span><span class=\"mtk1\">: [</span><span class=\"mtk18\">.....</span><span class=\"mtk1\">], </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t\t</span><span class=\"mtk13\">&quot;domains&quot;</span><span class=\"mtk1\">: [</span><span class=\"mtk18\">.....</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t},</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t</span><span class=\"mtk13\">&quot;sso&quot;</span><span class=\"mtk1\">: [</span><span class=\"mtk18\">.....</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\t}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>签名(sign)生成方式：</h3>\n<blockquote>\n<p>把接口所需所有参数拼接，如utk=xx&#x26;time=xx，按参数名称排序，最后再拼接上密钥App-Secret，做md5加密 (callback不需要参与sign校检)           ------<a href=\"https://github.com/fython/BilibiliAPIDocs\">https://github.com/fython/BilibiliAPIDocs</a></p>\n</blockquote>\n<p>PHP 版本:</p>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"php\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk5\">/**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@param</span><span class=\"mtk5\"> $params array 参数列表</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@param</span><span class=\"mtk5\"> $key 加密密钥</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@return</span><span class=\"mtk5\"> </span><span class=\"mtk5 mtkb\">array</span><span class=\"mtk5\"> sign:加密校验串,params:参数拼接串</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk6 mtkb\">function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">get_sign</span><span class=\"mtk1\">(</span><span class=\"mtk13\">$params</span><span class=\"mtk1\">,</span><span class=\"mtk13\"> $key</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk13\">$_data</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk12\">array</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">ksort</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$params</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">reset</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$params</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6 mtkb\">foreach</span><span class=\"mtk1\"> (</span><span class=\"mtk13\">$params</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">as</span><span class=\"mtk1\"> </span><span class=\"mtk13\">$k</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk13\">$v</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">// rawurlencode 返回的转义数字必须为大写( 如%2F )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk13\">$_data</span><span class=\"mtk1\">[] </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk13\">$k</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">.</span><span class=\"mtk1\"> </span><span class=\"mtk19\">&#39;=&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">.</span><span class=\"mtk1\"> </span><span class=\"mtk12\">rawurlencode</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$v</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk13\">$_sign</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk12\">implode</span><span class=\"mtk15\">(</span><span class=\"mtk19\">&#39;&amp;&#39;</span><span class=\"mtk15\">, </span><span class=\"mtk13\">$_data</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6 mtkb\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">array</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk19\">&#39;sign&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">strtolower</span><span class=\"mtk15\">(</span><span class=\"mtk12\">md5</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$_sign</span><span class=\"mtk15\"> </span><span class=\"mtk15 mtkb\">.</span><span class=\"mtk15\"> </span><span class=\"mtk13\">$key</span><span class=\"mtk15\">))</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk19\">&#39;params&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk13\">$_sign</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk12\">define</span><span class=\"mtk15\">(</span><span class=\"mtk19\">&quot;APP_SECRET&quot;</span><span class=\"mtk15\">,</span><span class=\"mtk19\">&quot;abcdef123456&quot;</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> </span><span class=\"mtk12\">get_sign</span><span class=\"mtk15\">(</span><span class=\"mtk12\">array</span><span class=\"mtk15\">(</span><span class=\"mtk19\">&quot;type&quot;</span><span class=\"mtk15 mtkb\">=&gt;</span><span class=\"mtk19\">&quot;json&quot;</span><span class=\"mtk15\">),APP_SECRET)</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>js版本:</p>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"js\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk12\">&lt;script</span><span class=\"mtk1\"> </span><span class=\"mtk16\">type</span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk19\">&quot;text/javascript&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk16\">src</span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk19\">&quot;http://static.hdslb.com/js/md5.js&quot;</span><span class=\"mtk12\">&gt;</span><span class=\"mtk1\">/script&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> function get_sign(params, key)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk15\">var</span><span class=\"mtk1\"> </span><span class=\"mtk15\">s_keys</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> [];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk12\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk15\">var</span><span class=\"mtk1\"> </span><span class=\"mtk15\">i</span><span class=\"mtk1\"> </span><span class=\"mtk6 mtkb\">in</span><span class=\"mtk1\"> </span><span class=\"mtk15\">params</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t\ts_keys.push(i);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk15\">s_keys.</span><span class=\"mtk12\">sort</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk15\">var</span><span class=\"mtk1\"> </span><span class=\"mtk15\">data</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk19\">&quot;&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk12\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk15\">var</span><span class=\"mtk1\"> </span><span class=\"mtk15\">i</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk15\">i</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">&lt;</span><span class=\"mtk1\"> </span><span class=\"mtk15\">s_keys</span><span class=\"mtk1\">.</span><span class=\"mtk15\">length</span><span class=\"mtk1\">; </span><span class=\"mtk15\">i</span><span class=\"mtk15 mtkb\">++</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t\t</span><span class=\"mtk5\">// encodeURIComponent 返回的转义数字必须为大写( 如 %2F )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t\tdata+=(data ? </span><span class=\"mtk19\">&quot;&amp;&quot;</span><span class=\"mtk13\"> :</span><span class=\"mtk1\"> </span><span class=\"mtk19\">&quot;&quot;</span><span class=\"mtk1\">)</span><span class=\"mtk15 mtkb\">+</span><span class=\"mtk15\">s_keys</span><span class=\"mtk1\">[</span><span class=\"mtk15\">i</span><span class=\"mtk1\">]</span><span class=\"mtk15 mtkb\">+</span><span class=\"mtk19\">&quot;=&quot;</span><span class=\"mtk15 mtkb\">+</span><span class=\"mtk12\">encodeURIComponent</span><span class=\"mtk1\">(</span><span class=\"mtk15\">params</span><span class=\"mtk1\">[</span><span class=\"mtk15\">s_keys</span><span class=\"mtk1\">[</span><span class=\"mtk15\">i</span><span class=\"mtk1\">]]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t</span><span class=\"mtk15\">return</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t\t</span><span class=\"mtk19\">&quot;sign&quot;</span><span class=\"mtk13\">:</span><span class=\"mtk12\">hex_md5</span><span class=\"mtk1\">(</span><span class=\"mtk15\">data</span><span class=\"mtk15 mtkb\">+</span><span class=\"mtk15\">key</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t\t</span><span class=\"mtk19\">&quot;params&quot;</span><span class=\"mtk13\">:</span><span class=\"mtk15\">data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> \t};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk1\"> }</span></span></span></code></pre>\n<h3>password 生成方式</h3>\n<p>在明文密码前拼接从<a href=\"https://passport.bilibili.com/api/oauth2/getKey%E5%BE%97%E6%9D%A5%E7%9A%84hash%EF%BC%8C%E7%94%A8%E5%BE%97%E6%9D%A5%E7%9A%84%E5%85%AC%E9%92%A5%E5%81%9Arsa%E5%8A%A0%E5%AF%86%E5%86%8Dbase64\">https://passport.bilibili.com/api/oauth2/getKey得来的hash，用得来的公钥做rsa加密再base64</a>  </p>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"php\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk5\">/**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@param</span><span class=\"mtk5\"> $key 加密公钥</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@param</span><span class=\"mtk5\"> $hash string 哈希</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@param</span><span class=\"mtk5\"> $pwd string 明文密码</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> * </span><span class=\"mtk5 mtkb\">@return</span><span class=\"mtk5\"> </span><span class=\"mtk5 mtkb\">string</span><span class=\"mtk5\"> base64后的加密密码</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk5\"> */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk6 mtkb\">function</span><span class=\"mtk1\"> </span><span class=\"mtk12\">get_rsa_pwd</span><span class=\"mtk1\">(</span><span class=\"mtk13\">$key</span><span class=\"mtk1\">,</span><span class=\"mtk13\">$hash</span><span class=\"mtk1\">,</span><span class=\"mtk13\">$pwd</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk13\">$pu_key</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtkb\">=</span><span class=\"mtk1\"> </span><span class=\"mtk12\">openssl_pkey_get_public</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$key</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6 mtkb\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk13\">$loginkey</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">openssl_public_encrypt</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$hash</span><span class=\"mtk15\"> </span><span class=\"mtk15 mtkb\">.</span><span class=\"mtk15\"> </span><span class=\"mtk13\">$pwd</span><span class=\"mtk15\"> ,</span><span class=\"mtk13\">$rsa_pwd</span><span class=\"mtk15\">,</span><span class=\"mtk13\">$pu_key</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk6 mtkb\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">base64_encode</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$rsa_pwd</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk6 mtkb\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk6 mtkb\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6 mtkb\">false</span><span class=\"mtk1\"> ;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<p>这些都知道了，你还写不出来登录？？</p>\n<h3>demo</h3>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">https://nworm.cf/my/bili/login.php?user=a&amp;pwd=b</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">参数都懂吧</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">我不会记录账号密码，也没有必要</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">不相信我的，请使用小号</span></span></code></pre>\n<h3>源码</h3>\n<p><a href=\"https://github.com/1574242600/bili-login\">https://github.com/1574242600/bili-login</a>\n我没写判断</p>\n<h3>关于验证码的问题</h3>\n<p>关于验证码的问题\n<a href=\"https://passport.bilibili.com/captcha\">https://passport.bilibili.com/captcha</a>\n在请求b站登录api（或demo，不过demo的sid的值请自行解析，我懒）时，它会返回一个cookies， 名称为sid\n带着sid请求上面的链接，得到验证码图片，和名为JSESSIONID的session\n最后带着上面的cookies ，再加个请求参数captcha，值就是验证码\n就行了</p>\n<h3>坑</h3>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"php\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk12\">curl_setopt</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$lo</span><span class=\"mtk15\">, CURLOPT_POSTFIELDS,</span><span class=\"mtk13\">$data</span><span class=\"mtk15\">)</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<pre class=\"grvsc-container code-line dracula-theme-from-intellij\" data-language=\"php\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk12\">curl_setopt</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$lo</span><span class=\"mtk15\">, CURLOPT_POSTFIELDS,</span><span class=\"mtk12\">http_build_query</span><span class=\"mtk15\">(</span><span class=\"mtk13\">$data</span><span class=\"mtk15\">))</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>区别：<a href=\"https://www.cnblogs.com/52php/p/5677689.html\">https://www.cnblogs.com/52php/p/5677689.html</a>\n(会导致b站认为你的请求非法)\n这玩意害我蒙了半天\n以后我绝对加http<em>build</em>query()</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dracula-theme-from-intellij {\n    color: #d4d4d4;\n    background-color: #212122;\n  }\n  .dracula-theme-from-intellij .mtkb { font-weight: bold; }\n  .dracula-theme-from-intellij .mtk1 { color: #D4D4D4; }\n  .dracula-theme-from-intellij .mtk13 { color: #9876AA; }\n  .dracula-theme-from-intellij .mtk7 { color: #6897BB; }\n  .dracula-theme-from-intellij .mtk5 { color: #808080; }\n  .dracula-theme-from-intellij .mtk19 { color: #6A8759; }\n  .dracula-theme-from-intellij .mtk18 { color: #F44747; }\n  .dracula-theme-from-intellij .mtk6 { color: #CC7832; }\n  .dracula-theme-from-intellij .mtk12 { color: #FFC66D; }\n  .dracula-theme-from-intellij .mtk15 { color: #A9B7C6; }\n  .dracula-theme-from-intellij .mtk16 { color: #BABABA; }\n  .dracula-theme-from-intellij .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>"}},"pageContext":{"id":"7df7a196-a635-5ff3-9091-f781fe464ae3"}},"staticQueryHashes":["1528757306","2428300253","2428300253","2428300253","3159585216","3159585216","3741834850","4209591199","847439237"]}